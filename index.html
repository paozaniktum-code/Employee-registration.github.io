<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payroll Report System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap" rel="stylesheet">
  
  <style>
    body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
    
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ß‡∏£ */
    .shift-cell { min-width: 28px; height: 35px; border: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
    .shift-d { background-color: #fef3c7; color: #92400e; }
    .shift-n { background-color: #dbeafe; color: #1e40af; }
    .shift-dn { background-color: #a78bfa; color: #ffffff; }
    .shift-x { background-color: #fecaca; color: #b91c1c; }

    /* ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå (Print View) */
    @media print {
        @page { size: landscape; margin: 1cm; }
        body { background: white; }
        .no-print { display: none !important; }
        .table-wrapper { overflow: visible !important; max-height: none !important; border: none !important; }
        table { width: 100% !important; border: 1px solid #000 !important; font-size: 12px !important; }
        th, td { border: 1px solid #000 !important; padding: 4px !important; }
        th { background-color: #f3f4f6 !important; color: black !important; }
        .sticky-1, .sticky-2, .sticky-3 { position: static !important; background: white !important; }
        .net-column { background-color: #e2e8f0 !important; font-weight: bold !important; color: black !important; }
    }

    .table-wrapper { overflow: auto; max-height: 70vh; border-radius: 8px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
    table { border-collapse: collapse; min-width: 2000px; }
    th { background: #1e3a8a; color: white; padding: 10px; position: sticky; top: 0; z-index: 10; border: 1px solid #334155; }
    td { padding: 8px; border: 1px solid #e2e8f0; background: white; }
    
    /* Sticky Columns */
    .sticky-1 { position: sticky; left: 0; z-index: 20; background: #f1f5f9 !important; }
    .sticky-2 { position: sticky; left: 50px; z-index: 20; background: white !important; border-right: 2px solid #cbd5e1 !important; }
    
    .editable { cursor: pointer; border-bottom: 1px dashed #3b82f6; font-weight: 600; color: #2563eb; }
  </style>
 </head>
 <body>

  <div class="p-6">
    <div class="mb-6 text-center">
        <h1 class="text-2xl font-bold text-gray-800" id="report-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h1>
        <p class="text-gray-500 no-print">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏î "‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô"</p>
    </div>

    <div class="no-print flex flex-wrap gap-4 bg-white p-4 rounded-xl shadow-sm mb-6 items-end">
        <div>
            <label class="block text-xs font-bold mb-1">‡∏™‡∏≤‡∏Ç‡∏≤</label>
            <select id="branch-select" onchange="loadData()" class="border p-2 rounded-lg bg-gray-50">
                <option value="1">üè¢ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà 1</option>
                <option value="2">üè¨ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà 2</option>
            </select>
        </div>
        <div>
            <label class="block text-xs font-bold mb-1">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ</label>
            <div class="flex gap-2">
                <select id="month-select" onchange="renderTable()" class="border p-2 rounded-lg"></select>
                <select id="year-select" onchange="renderTable()" class="border p-2 rounded-lg"></select>
            </div>
        </div>
        <button onclick="window.print()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2 rounded-lg font-bold transition flex items-center gap-2">
            <span>üìä</span> ‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (‡∏û‡∏¥‡∏°‡∏û‡πå PDF)
        </button>
    </div>

    <div class="table-wrapper bg-white">
        <table id="payroll-table">
            <thead>
                <tr>
                    <th class="sticky-1">#</th>
                    <th class="sticky-2">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
                    <th id="days-row">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÄ‡∏ß‡∏£</th>
                    <th>‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á</th>
                    <th>‡πÇ‡∏≠‡∏ó‡∏µ</th>
                    <th>‡∏´‡∏¢‡∏∏‡∏î (‡∏ß‡∏±‡∏ô)</th>
                    <th>%‡∏Ç‡∏≤‡∏¢</th>
                    <th>‡∏à‡∏ö‡πÄ‡∏Ñ‡∏™</th>
                    <th class="bg-orange-600">‡∏Ñ‡πà‡∏≤‡∏ä‡∏∏‡∏î</th>
                    <th class="bg-orange-600">‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                    <th class="bg-orange-600">‡∏ô‡πâ‡∏≥/‡πÑ‡∏ü</th>
                    <th class="bg-orange-600">‡∏ú‡∏¥‡∏î‡∏Å‡∏è</th>
                    <th class="bg-orange-600">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</th>
                    <th class="bg-green-700">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</th>
                </tr>
            </thead>
            <tbody id="table-body">
                </tbody>
        </table>
    </div>
  </div>

  <script>
    // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ---
    let months = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
    let mSelect = document.getElementById('month-select');
    let ySelect = document.getElementById('year-select');

    // ‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏µ ‡∏û.‡∏®. (+10 ‡∏õ‡∏µ)
    let currentYear = new Date().getFullYear() + 543;
    for(let i = currentYear - 2; i <= currentYear + 10; i++) {
        let opt = document.createElement('option'); opt.value = i; opt.textContent = i; ySelect.appendChild(opt);
    }
    months.forEach((m, i) => {
        let opt = document.createElement('option'); opt.value = i+1; opt.textContent = m; mSelect.appendChild(opt);
    });
    mSelect.value = new Date().getMonth() + 1;
    ySelect.value = currentYear;

    function renderTable() {
        const branch = document.getElementById('branch-select').value;
        const month = mSelect.value;
        const year = ySelect.value;
        const daysInMonth = new Date(year - 543, month, 0).getDate();
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
        document.getElementById('report-title').textContent = `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà ${branch} ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${months[month-1]} ‡∏û.‡∏®. ${year}`;

        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
        let daysHtml = `<div class="flex">`;
        for(let d=1; d<=31; d++) {
            daysHtml += `<div class="shift-cell ${d > daysInMonth ? 'bg-gray-200' : ''}">${d}</div>`;
        }
        document.getElementById('days-row').innerHTML = daysHtml + `</div>`;

        // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å LocalStorage)
        const body = document.getElementById('table-body');
        body.innerHTML = `
            <tr>
                <td class="sticky-1 text-center">1</td>
                <td class="sticky-2">
                    <div class="font-bold">‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
                    <div class="text-[10px] text-blue-600">[‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô] ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</div>
                </td>
                <td class="p-0"><div class="flex">${generateDummyShifts(daysInMonth)}</div></td>
                <td class="text-right">15,000</td>
                <td class="text-right">1,200</td>
                <td class="text-center font-bold text-red-600">4</td>
                <td class="text-right">500</td>
                <td class="text-right">300</td>
                <td class="text-right text-orange-600">0</td>
                <td class="text-right text-orange-600">0</td>
                <td class="text-right text-orange-600">100</td>
                <td class="text-right text-orange-600">0</td>
                <td class="text-right text-orange-600">0</td>
                <td class="text-right font-bold text-green-700 bg-green-50">16,900</td>
            </tr>
        `;
    }

    function generateDummyShifts(max) {
        let h = "";
        for(let i=1; i<=31; i++) {
            let s = i <= max ? (i % 7 === 0 ? 'X' : 'D') : '';
            let c = s === 'D' ? 'shift-d' : (s === 'X' ? 'shift-x' : '');
            h += `<div class="shift-cell ${c}">${s}</div>`;
        }
        return h;
    }

    function loadData() { renderTable(); }
    window.onload = renderTable;
  </script>

 </body>
</html>
